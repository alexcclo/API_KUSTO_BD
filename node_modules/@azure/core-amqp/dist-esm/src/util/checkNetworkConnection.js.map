{"version":3,"file":"checkNetworkConnection.js","sourceRoot":"","sources":["../../../src/util/checkNetworkConnection.ts"],"names":[],"mappings":"AAAA,4DAA4D;AAC5D,kCAAkC;AAElC,OAAO,EAAE,OAAO,EAAE,WAAW,EAAE,OAAO,EAAE,MAAM,KAAK,CAAC;AACpD,OAAO,EAAE,MAAM,EAAE,MAAM,QAAQ,CAAC;AAEhC;;;;GAIG;AACH,MAAM,UAAU,sBAAsB,CAAC,IAAY;IACjD,OAAO,IAAI,OAAO,CAAC,CAAC,GAAG,EAAE,EAAE;QACzB,MAAM,CAAC,OAAO,CAAC,6DAA6D,CAAC,CAAC;QAC9E,OAAO,CAAC,IAAI,EAAE,UAAS,GAAQ;YAC7B,IAAI,GAAG,EAAE;gBACP,MAAM,CAAC,OAAO,CACZ,qEAAqE,EACrE,GAAG,CAAC,IAAI,IAAI,GAAG,CAAC,IAAI,EACpB,GAAG,CACJ,CAAC;gBACF,2GAA2G;gBAC3G,wGAAwG;gBACxG,IAAI,GAAG,CAAC,IAAI,KAAK,WAAW,IAAI,GAAG,CAAC,IAAI,KAAK,OAAO,EAAE;oBACpD,OAAO,GAAG,CAAC,KAAK,CAAC,CAAC;iBACnB;aACF;iBAAM;gBACL,MAAM,CAAC,OAAO,CAAC,yEAAyE,CAAC,CAAC;aAC3F;YAED,OAAO,GAAG,CAAC,IAAI,CAAC,CAAC;QACnB,CAAC,CAAC,CAAC;IACL,CAAC,CAAC,CAAC;AACL,CAAC","sourcesContent":["// Copyright (c) Microsoft Corporation. All rights reserved.\n// Licensed under the MIT License.\n\nimport { resolve, CONNREFUSED, TIMEOUT } from \"dns\";\nimport { logger } from \"../log\";\n\n/**\n * Checks whether a network connection is detected.\n * @ignore\n * @internal\n */\nexport function checkNetworkConnection(host: string): Promise<boolean> {\n  return new Promise((res) => {\n    logger.verbose(\"Calling dns.resolve to determine network connection status.\");\n    resolve(host, function(err: any): void {\n      if (err) {\n        logger.verbose(\n          \"Error thrown from dns.resolve in network connection check: '%s', %O\",\n          err.code || err.name,\n          err\n        );\n        // List of possible DNS error codes: https://nodejs.org/dist/latest-v12.x/docs/api/dns.html#dns_error_codes\n        // Only when dns.resolve returns an error we expect to see when the network is down, resolve as 'false'.\n        if (err.code === CONNREFUSED || err.code === TIMEOUT) {\n          return res(false);\n        }\n      } else {\n        logger.verbose(\"Successfully resolved host via dns.resolve in network connection check.\");\n      }\n\n      return res(true);\n    });\n  });\n}\n"]}